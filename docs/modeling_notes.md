After extensive investigation and multiple attempts to implement a robust "main effects only" model for up to 4 factors using `statsmodels.MixedLM`, I have encountered persistent numerical instability and convergence issues.

**Summary of Findings:**

1.  **Initial Bug Fixed**: The primary bug where the "main effects" model was never actually executed (due to a dispatch error in `run_crossed_msa` which forced a 2-factor crossed model) has been identified and fixed. A new unified entry point `run_msa` now correctly dispatches to `_run_main_effects_msa` when requested.
2.  **`statsmodels.MixedLM` Limitations**: Despite various attempts to improve numerical stability (including formula simplification, data shuffling, response normalization, and noise injection), `statsmodels.MixedLM` consistently fails to converge or produces incorrect variance component estimates (often near zero for certain factors) when trying to model multiple independent random intercepts (one for each factor) for 4 factors. This indicates a fundamental numerical stability issue within `statsmodels` for this specific model structure and complexity.
3.  **`pymer4` (R `lme4`) Dependency Issue**: While `pymer4` (a Python wrapper for R's `lme4` package, a robust mixed-model solver) was explored as an alternative, it was deemed unsuitable as an "optional" dependency within the strict constraints. `pymer4` requires a full R installation and the `rpy2` Python package, which necessitates significant external setup and cannot be transparently handled as a simple `pip install`.

**Conclusion**:
Given the limitations of `statsmodels.MixedLM` for this specific "main effects only" random effects model (multiple independent random intercepts for up to 4 factors) and the constraints against adding complex external dependencies, a robust implementation of the requested "main effects only" model is not feasible with the current Python-only dependency stack.

**Proposed Alternatives / Next Steps:**

1.  **Clarify "Main Effects Only" Intent**:
    *   If the primary goal is a *fixed-effects ANOVA* to assess the statistical significance of each main factor (ignoring random variation from interactions), then the current reference-only ANOVA table generated by `_run_main_effects_msa` can serve this purpose, with clear warnings that its p-values are fixed-effects based and do not reflect random variation. However, this does not provide variance components for each factor.
    *   If the primary goal is to *estimate variance components for each main factor* (e.g., Part, Operator, Gage, Day) without interactions for up to 4 factors, the `statsmodels.MixedLM` approach is proving unreliable.

2.  **Simplified "Main Effects Only" Interpretation for GRR**:
    *   Perhaps the "main effects only" model primarily intends to provide Part-to-Part and a pooled "Reproducibility" component (sum of all other factor variances). If so, a simpler approach might be to use a 2-factor crossed model (Part & Operator) and sum other factor variances into the residual, though this would mean not reporting individual factor variances for "Gage" or "Day". This deviates from the request to have individual factor VCs.

3.  **External Tool Recommendation**: For robust "main effects only" random effects models with multiple factors, recommend users export their data and analyze it in dedicated statistical software packages known for their mixed-model capabilities (e.g., R with `lme4`, JMP, Minitab). The CLI app would then explicitly state this limitation.

4.  **Revisit Dependency Constraints**: If a robust "main effects only" variance component estimation for multiple factors is a hard requirement, then the constraint against external dependencies (like R) might need to be relaxed, or a more flexible Python library might need to be developed/integrated if it exists and can meet the constraints.

I await your guidance on how to proceed.